# =====================================================
# BACKEND ENVIRONMENT VARIABLES
# BeZhas Web3 Social Network
# =====================================================

# Node Environment
NODE_ENV=development
PORT=3001
LOG_LEVEL=info

# =====================================================
# TWO-FACTOR AUTHENTICATION (2FA)
# =====================================================

# Enable TOTP (Google Authenticator, Authy, etc.)
# Set to 'true' when HTTPS is configured
ENABLE_2FA=false

# Enable WebAuthn / Passkeys (biometrics, hardware keys)
# IMPORTANT: WebAuthn requires HTTPS in production!
ENABLE_WEBAUTHN=false

# WebAuthn Configuration (update for production)
# APP_NAME is used in authenticator apps and passkey prompts
APP_NAME=Bezhas Network
# WEBAUTHN_RP_ID should match your domain (without protocol)
WEBAUTHN_RP_ID=localhost
# WEBAUTHN_ORIGIN must match exactly the URL users access (with protocol and port)
WEBAUTHN_ORIGIN=http://localhost:5173

# For production (example):
# WEBAUTHN_RP_ID=bezhas.com
# WEBAUTHN_ORIGIN=https://bezhas.com

# Frontend URL
FRONTEND_URL=http://localhost:5173

# CORS Configuration
ALLOWED_ORIGINS=http://localhost:5173,http://127.0.0.1:58425
CORS_CREDENTIALS=true

# =====================================================
# AI PROVIDERS API KEYS
# =====================================================

# OpenAI (GPT-4, GPT-3.5, GPT-4o, etc.)
OPENAI_API_KEY=sk-your-openai-api-key-here

# Anthropic (Claude 3 Opus, Sonnet, Haiku)
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here

# Google AI (Gemini Pro, Gemini 1.5)
GOOGLE_API_KEY=your-google-api-key-here

# xAI (Grok 2, Grok 1.5)
XAI_API_KEY=xai-your-xai-api-key-here

# DeepSeek (DeepSeek Chat, DeepSeek Coder)
DEEPSEEK_API_KEY=sk-your-deepseek-api-key-here

# =====================================================
# BLOCKCHAIN CONFIGURATION
# =====================================================

# Polygon RPC URL (Alchemy, Infura, QuickNode, etc.)
POLYGON_RPC_URL=https://polygon-mainnet.g.alchemy.com/v2/YOUR_API_KEY
# For testnet (Amoy):
# POLYGON_RPC_URL=https://polygon-amoy.g.alchemy.com/v2/YOUR_API_KEY

# Smart Contract Addresses
CONTENT_VALIDATOR_ADDRESS=0x0000000000000000000000000000000000000000
BEZHAS_TOKEN_ADDRESS=0x0000000000000000000000000000000000000000
REWARDS_CALCULATOR_ADDRESS=0x0000000000000000000000000000000000000000

# =====================================================
# IPFS CONFIGURATION (Pinata)
# =====================================================

# Pinata API Keys (https://app.pinata.cloud/)
# Get free API keys: https://app.pinata.cloud/register
# Free Plan: 1GB storage, 100 NFTs/month
PINATA_API_KEY=your-pinata-api-key-here
PINATA_SECRET_KEY=your-pinata-secret-api-key-here

# Pinata Gateway (optional, default: https://gateway.pinata.cloud/ipfs/)
PINATA_GATEWAY=https://gateway.pinata.cloud/ipfs/

# IMPORTANT: Without these keys, system will use IPFS mock in development
# Production deployments MUST have valid Pinata keys configured

# Alternative: Web3.Storage (optional)
# WEB3_STORAGE_TOKEN=your_web3_storage_token

# Backend Wallet (for delegated validations)
BACKEND_PRIVATE_KEY=your_private_key_here
TREASURY_WALLET=0x0000000000000000000000000000000000000000

# Admin Wallet (for revocations and admin functions)
ADMIN_PRIVATE_KEY=your_admin_private_key_here

# =====================================================
# STRIPE CONFIGURATION (VIP Subscriptions & Payments)
# =====================================================

# Stripe Keys (https://dashboard.stripe.com/)
# SECURITY WARNING: Never commit actual keys - use environment variables
# Test keys (prefix: sk_test_ and pk_test_)
# Live keys (prefix: sk_live_ and pk_live_)
STRIPE_SECRET_KEY=your_stripe_secret_key_here
STRIPE_PUBLISHABLE_KEY=your_stripe_publishable_key_here

# Stripe Webhook Secret (for VIP subscription webhooks)
# Generate in: Dashboard > Developers > Webhooks > Add endpoint
# Events to listen: customer.subscription.*, invoice.payment_*
STRIPE_WEBHOOK_SECRET=your_stripe_webhook_secret_here

# IMPORTANT: Setup webhook endpoint at https://yourdomain.com/api/stripe/webhooks
# For local testing, use Stripe CLI: stripe listen --forward-to localhost:3001/api/stripe/webhooks

# =====================================================
# MOONPAY CONFIGURATION (FIAT Gateway)
# =====================================================

# MoonPay API Keys (https://www.moonpay.com/)
# Register: https://dashboard.moonpay.com/signup
MOONPAY_API_KEY=your_moonpay_api_key_here
MOONPAY_SECRET_KEY=your_moonpay_secret_key_here

# MoonPay Webhook Secret (for transaction status updates)
MOONPAY_WEBHOOK_SECRET=your_moonpay_webhook_secret_here

# IMPORTANT: Without MoonPay keys, FIAT purchases will be disabled
# Free testing available with sandbox environment

# =====================================================
# DATABASE CONFIGURATION
# =====================================================

# PostgreSQL
DATABASE_URL=postgresql://user:password@localhost:5432/bezhas_db
DB_HOST=localhost
DB_PORT=5432
DB_NAME=bezhas_db
DB_USER=bezhas_user
DB_PASSWORD=your_db_password

# MongoDB
MONGODB_URI=mongodb://localhost:27017/bezhas

# Redis (for Bull queues and cache)
REDIS_URL=redis://127.0.0.1:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# =====================================================
# JWT & AUTHENTICATION
# =====================================================

JWT_SECRET=a_very_strong_and_long_secret_key_for_jwt_32_chars_or_more
JWT_EXPIRES_IN=7d
SESSION_SECRET=your_session_secret_here

# Admin Token for protected endpoints
ADMIN_TOKEN=your_super_secret_admin_token

# Development only: Enable auth bypass
AUTH_BYPASS_ENABLED=false

# Super Admin Wallets (Whitelist - Cannot be demoted by anyone)
# Add wallet addresses separated by commas (all lowercase)
# Example: SUPER_ADMIN_WALLETS=0xabc123...,0xdef456...
SUPER_ADMIN_WALLETS=0x52df82920cbae522880dd7657e43d1a754ed044e

# =====================================================
# ENCRYPTION
# =====================================================

# Encryption key for sensitive data (must be 32 characters)
CONTACT_ENCRYPTION_KEY=this_is_a_32_character_long_key!

# =====================================================
# GOOGLE AI (Gemini API)
# =====================================================

GEMINI_API_KEY=demo_key_for_development

# =====================================================
# MONITORING & LOGGING
# =====================================================

# Sentry (error tracking)
SENTRY_DSN=https://your_sentry_dsn

# Datadog (APM)
DD_API_KEY=your_datadog_api_key
DD_SERVICE=bezhas-backend
DD_ENV=development

# =====================================================
# RATE LIMITING
# =====================================================

RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# =====================================================
# CONTENT VALIDATION FEES
# =====================================================

DEFAULT_BEZCOIN_FEE=10
DEFAULT_NATIVE_FEE=0.01
DEFAULT_FIAT_FEE_EUR=9.99
DEFAULT_FIAT_FEE_USD=10.99

# =====================================================
# QUEUE CONFIGURATION
# =====================================================

VALIDATION_QUEUE_CONCURRENCY=5
VALIDATION_RETRY_ATTEMPTS=3
VALIDATION_RETRY_DELAY=5000

# =====================================================
# EVENT LISTENER CONFIGURATION
# =====================================================

HISTORICAL_BLOCKS_FETCH=43200
MAX_RECONNECT_ATTEMPTS=10
RECONNECT_DELAY_MS=5000
DISABLE_BLOCKCHAIN_LISTENER=false
DISABLE_QUEUE_WORKER=false

# =====================================================
# CACHE CONFIGURATION
# =====================================================

VALIDATION_CACHE_TTL=300
STATS_CACHE_TTL=60

# =====================================================
# NOTIFICATIONS
# =====================================================

# Email (SendGrid, Mailgun, etc.)
EMAIL_SERVICE=sendgrid
EMAIL_API_KEY=your_email_api_key
EMAIL_FROM=noreply@bezhas.com

# Push notifications (Firebase Cloud Messaging)
FCM_SERVER_KEY=your_fcm_server_key

# =====================================================
# WEBSOCKET CONFIGURATION
# =====================================================

WS_PORT=3002
WS_PATH=/ws

# =====================================================
# DEVELOPMENT & DEBUG
# =====================================================

DEBUG=bezhas:*
MOCK_STRIPE=false

# =====================================================
# AUTOMATION ENGINE CONFIGURATION
# =====================================================

# Enable/disable automation system
AUTOMATION_ENABLED=true

# ML Service Configuration
ML_SERVICE_URL=http://localhost:8000
ML_API_KEY=your-ml-api-key-here

# Blockchain Automation
RPC_URL=https://polygon-mainnet.g.alchemy.com/v2/YOUR_API_KEY
ETHEREUM_RPC_URL=https://eth-mainnet.g.alchemy.com/v2/YOUR_API_KEY
AUTOMATION_PRIVATE_KEY=0xYOUR_AUTOMATION_WALLET_PRIVATE_KEY
BEZHAS_CORE_ADDRESS=0xYOUR_BEZHAS_CORE_CONTRACT_ADDRESS

# Halving Check Job Configuration
HALVING_CHECK_CRON=*/30 * * * *
HALVING_CHECK_ENABLED=true

# Oracle Configuration
ORACLE_API_KEY=your-oracle-api-key
ORACLE_REFRESH_INTERVAL=60000

# Nota: 
# - AUTOMATION_PRIVATE_KEY debe tener el rol AUTOMATION_ROLE en el contrato
# - ML_SERVICE_URL apunta al servicio Python de ML/AI (puerto 8000 por defecto)
# - HALVING_CHECK_CRON usa sintaxis cron (*/30 * * * * = cada 30 minutos)

# =====================================================
# SECURITY MONITORING
# =====================================================

# Discord Webhook for Security Alerts
DISCORD_WEBHOOK_URL=https://discord.gg/YOUR_WEBHOOK_ID

# Telegram Bot (optional)
TELEGRAM_BOT_TOKEN=
TELEGRAM_SECURITY_CHAT_ID=

# =====================================================
# UNIFIED SUBSCRIPTION SYSTEM (v2.0)
# =====================================================
# This section configures the new unified tier system that 
# links subscriptions with DeFi staking and AI costs.

# ===== Stripe Price IDs =====
# Create these products/prices in Stripe Dashboard:
# https://dashboard.stripe.com/products
# 
# IMPORTANT: Each tier needs 2 prices (monthly & yearly)

# Creator Pro Tier ($14.99/mo | $149.99/yr)
STRIPE_PRICE_CREATOR_MONTHLY=price_creator_monthly_xxx
STRIPE_PRICE_CREATOR_YEARLY=price_creator_yearly_xxx

# Business Enterprise Tier ($99.99/mo | $999.99/yr)
STRIPE_PRICE_BUSINESS_MONTHLY=price_business_monthly_xxx
STRIPE_PRICE_BUSINESS_YEARLY=price_business_yearly_xxx

# ===== Staking Configuration =====
# Base APY for staking pool (without tier multipliers)
BASE_STAKING_APY=12.5

# BEZ token to USD rate (for calculations)
BEZ_TO_USD_RATE=0.05

# ===== Token Lock Configuration =====
# Contract address for token lock (alternative to fiat subscription)
TOKEN_LOCK_CONTRACT_ADDRESS=0x0000000000000000000000000000000000000000

# Token lock amounts required per tier (in BEZ)
TOKEN_LOCK_CREATOR=5000
TOKEN_LOCK_BUSINESS=50000

# Token lock durations (in days)
TOKEN_LOCK_DURATION_CREATOR=90
TOKEN_LOCK_DURATION_BUSINESS=180

# ===== Staking Signature Verification =====
# Secret for generating staking APY verification signatures
# This allows the smart contract to verify tier-based APY multipliers
SUBSCRIPTION_SIGNATURE_SECRET=your_very_secure_signature_secret_32_chars_min

# ===== AI Rate Limiting =====
# Daily AI query limits per tier
AI_DAILY_LIMIT_STARTER=5
AI_DAILY_LIMIT_CREATOR=50
AI_DAILY_LIMIT_BUSINESS=9999

# AI model pricing per 1000 tokens (in BEZ)
AI_COST_GPT35=0.1
AI_COST_GPT4=1.0
AI_COST_GEMINI=0.3

# ===== Gas Subsidy Configuration =====
# Enable/disable gas subsidy feature
GAS_SUBSIDY_ENABLED=true

# Treasury wallet that pays for gas subsidies
GAS_SUBSIDY_TREASURY_WALLET=0x0000000000000000000000000000000000000000

# Max gas subsidy per transaction (in MATIC)
GAS_SUBSIDY_MAX_PER_TX=1.0

# ===== Cache Configuration =====
# TTL for AI inference caching (in seconds)
AI_CACHE_TTL=3600

# TTL for subscription status caching (in seconds)
SUBSCRIPTION_CACHE_TTL=300

# =====================================================
